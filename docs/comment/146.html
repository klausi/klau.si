<!DOCTYPE html>
<html lang="en" dir="ltr" class="no-js">
  <head>
    <meta charset="utf-8" />
<meta name="Generator" content="Drupal 8 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<link rel="canonical" href="../node/34.html" />
<link rel="shortlink" href="../node/34.html" />
<link rel="revision" href="../node/34.html" />

    <title>Running PHP 5.3 and 5.2 in parallel with nginx | Klausi&#039;s Weblog</title>
    <link rel="stylesheet" media="all" href="../files/css/css_c8uKrkdw3uTl-xXgGz0TtfMpOZq9ps2b3GoXRcXqFfo.css%3Fprerue.css" />
<link rel="stylesheet" media="all" href="https://fonts.googleapis.com/css?family=Lato|Inconsolata|Merriweather:400,400italic,700,700italic&amp;subset=latin,latin-ext" />
<link rel="stylesheet" media="all" href="../files/css/css_nnYw3irVvzE0RwPEuTYB4Tml0tweJsM-gJZkF-TjK4U.css%3Fprerue.css" />

    
<!--[if lte IE 8]>
<script src="/files/js/js_VtafjXmRvoUgAzqzYTA3Wrjkx9wcWhjP0G4ZnnqRamA.js"></script>
<![endif]-->
<script src="../core/assets/vendor/modernizr/modernizr.min.js%3Fv=3.3.1"></script>

  </head>
  <body class="writer path-node page-node-type-story">
        <a href="146.html#main-content" class="visually-hidden focusable skip-link">
      Skip to main content
    </a>
    
      <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
    <div id="wrapper" class="wrapper" style="max-width: 630px;">
  
  <header role="banner" id="site-header">
  	<div class="head-wrap clearfix">
        <div class="region region-header">
    <div id="block-writer-branding" class="block block-system block-system-branding-block">
  
    
        <div class="logo-wrap">
      <a href="../index.html" title="Home" rel="home" id="logo">
        <img src="../files/uhura-drupal65_0.png" alt="Home" />
      </a>
    </div>
  
      <hgroup class="site-name-wrap">
              <h1 id="site-name">
          <a href="../index.html">Klausi&#039;s Weblog</a>
        </h1>
                    <h2 id="site-slogan">Trying to do a useful Blog</h2>
          </hgroup>
  </div>

  </div>

        <div class="region region-main-menu">
    <nav role="navigation" aria-labelledby="block-writer-main-menu-menu" id="block-writer-main-menu" class="block block-menu navigation menu--main">
            
  <h2 class="visually-hidden" id="block-writer-main-menu-menu">Main navigation</h2>
  

        
              <ul class="menu">
                    <li class="menu-item">
        <a href="../node/50.html" title="Drupal development setup on Ubuntu" data-drupal-link-system-path="node/50">Drupal dev on Ubuntu</a>
              </li>
                <li class="menu-item">
        <a href="../rss.xml" title="Subscribe to this feed to get updates on new blog posts" data-drupal-link-system-path="rss.xml">RSS feed</a>
              </li>
                <li class="menu-item">
        <a href="../node/51.html" data-drupal-link-system-path="node/51">speaking</a>
              </li>
                <li class="menu-item">
        <a href="../node/1.html" data-drupal-link-system-path="node/1">about</a>
              </li>
                <li class="menu-item">
        <a href="../node/53.html" title="contact klausi" data-drupal-link-system-path="node/53">contact</a>
              </li>
        </ul>
  


  </nav>

  </div>

	  </div>
  </header>

  

  
  <main role="main" class="main-content">
  	<a id="main-content"></a>
          <div id="highlighted">  <div class="region region-highlighted">
    <div data-drupal-messages-fallback class="hidden"></div>

  </div>
</div>
    
    
        

    
    

    
      <div class="region region-content">
    <div id="block-writer-page-title" class="block block-core block-page-title-block">
  
    
      
  <h1 class="page-title"><span class="field field--name-title field--type-string field--label-hidden">Running PHP 5.3 and 5.2 in parallel with nginx</span>
</h1>


  </div>
<div id="block-writer-easybreeze-system-main" class="block block-system block-system-main-block">
  
    
      
<article id="node-34" class=" " role="article" >

  <header>
    

    
          <div class="meta">
        <time class="submitted writer-date" datetime="2011-01-17 18:16:42" pubdate="pubdate">17 Jan 2011</time>
      </div>
    
  </header>

  <div class="node-main contextual-region">

    

    <div >
            
            <div class="clearfix text-formatted field field--name-body field--type-text-with-summary field--label-hidden field__item"><p>
	The problem: you want to upgrade your Ubuntu server, but you still need PHP 5.2 for some old web sites (i.e. Drupal 5 is not PHP 5.3 compatible).<br />
	The solution: Go with the packaged PHP 5.3 for your new sites and compile PHP 5.2 yourself for the old ones. As we use the nginx webserver with FastCGI, we can choose per site which PHP CGI binary will handle the requests.</p>
<!--break--><p>
	The following steps were carried out on Ubuntu 10.10.</p>
<ul><li>
		Download PHP 5.2 from http://php.net</li>
<li>
		Extract the archive (tar xvzf php-5.2.X.tar.bz2)</li>
<li>
		Change to the new directory (cd php-5.2.X)</li>
<li>
		Run the configure script, we used the following options ("php52" is the name for configuration/data directories, instead of "php5" used by the ubuntu package):</li>
</ul><pre>
./configure --prefix=/usr/share/php52\
 --datadir=/usr/share/php52\
 --mandir=/usr/share/man\
 --bindir=/usr/bin/php52\
 --with-libdir=lib64\
 --includedir=/usr/include\
 --sysconfdir=/etc/php52/apache2\
 --with-config-file-path=/etc/php52/cli\
 --with-config-file-scan-dir=/etc/php52/conf.d\
 --localstatedir=/var \
 --disable-debug \
 --with-regex=php \
 --disable-rpath \
 --disable-static \
 --with-pic \
 --with-layout=GNU \
 --with-pear=/usr/share/php \
 --enable-calendar \
 --enable-sysvsem \
 --enable-sysvshm \
 --enable-sysvmsg \
 --enable-bcmath \
 --with-bz2 \
 --enable-ctype \
 --with-db4 \
 --without-gdbm \
 --with-iconv \
 --enable-exif \
 --enable-ftp \
 --with-gettext \
 --enable-mbstring \
 --with-pcre-regex=/usr \
 --enable-shmop \
 --enable-sockets \
 --enable-wddx \
 --with-libxml-dir=/usr \
 --with-zlib \
 --with-kerberos=/usr \
 --with-openssl=/usr \
 --enable-soap \
 --enable-zip \
 --with-mhash=yes \
 --with-exec-dir=/usr/lib/php5/libexec \
 --without-mm \
 --with-curl=shared,/usr \
 --with-zlib-dir=/usr \
 --with-gd=shared,/usr --enable-gd-native-ttf \
 --with-gmp=shared,/usr \
 --with-jpeg-dir=shared,/usr \
 --with-xpm-dir=shared,/usr/X11R6 \
 --with-png-dir=shared,/usr \
 --with-freetype-dir=shared,/usr \
 --with-ttf=shared,/usr \
 --with-t1lib=shared,/usr \
 --with-ldap=shared,/usr \
 --with-ldap-sasl=/usr \
 --with-mysql=shared,/usr \
 --with-mysqli=shared,/usr/bin/mysql_config \
 --with-pspell=shared,/usr \
 --with-unixODBC=shared,/usr \
 --with-xsl=shared,/usr \
 --with-snmp=shared,/usr \
 --with-sqlite=shared,/usr \
 --with-mssql=shared,/usr \
 --with-tidy=shared,/usr \
 --with-xmlrpc=shared \
 --enable-pdo=shared \
 --without-pdo-dblib \
 --with-pdo-mysql=shared,/usr \
 --with-pdo-odbc=shared,unixODBC,/usr \
 --with-pdo-pgsql=shared,/usr/bin/pg_config \
 --with-pdo-sqlite=shared,/usr \
 --with-pdo-dblib=shared,/usr \
 --enable-force-cgi-redirect --enable-fastcgi \	
</pre><ul><li>
		The configure script may require additional dev-libraries, install them (incomplete list, you may reuqire others, too):</li>
</ul><pre>
aptitude install libxml2-dev libpcre3-dev libbz2-dev libcurl4-openssl-dev libgdbm-dev libdb-dev libjpeg62-dev libpng12-dev libxpm-dev
</pre><ul><li>
		Next execute</li>
</ul><pre>
make
</pre><ul><li>
		Now we can create a package from that and install it:</li>
</ul><pre>
sudo checkinstall
</pre><ul><li>
		Create the config directory /etc/php52 and copy/link the configuration files from /etc/php5</li>
</ul><pre>
sudo mkdir /etc/php52
sudo ln -s /etc/php5/conf.d /etc/php52
sudo ln -s /etc/php5/cli /etc/php52
</pre><ul><li>
		Now you can use /usr/bin/php52/php-cgi in your upstart/init script as PHP 5.2 binary. You should also have now a deb-package in the directory where you executed checkinstall. You can use that package on other servers as well (installation: sudo dpkg -i php-5.2.deb).</li>
</ul></div>
      
  <div class="field field--name-taxonomy-vocabulary-1 field--type-entity-reference field--label-above">
    <div class="field__label">Categories</div>
          <div class="field__items">
              <div class="field__item"><a href="../taxonomy/term/3.html" hreflang="en">Software</a></div>
          <div class="field__item"><a href="../taxonomy/term/6.html" hreflang="en">Drupal</a></div>
              </div>
      </div>
<section class="comments field field--name-comment-node-story field--type-comment field--label-above comment-wrapper">
      
    <h2 class="title">Comments</h2>
    
  
  <article  data-comment-user-id="0" id="comment-78" class="comment">
  
  <h3><a href="78.html#comment-78" class="permalink" rel="bookmark" hreflang="en">Shared modules (.so) are missing - only .a and .la in modules/</a></h3>
  

  <div class="submitted">On <time datetime="2011-05-13 18:24:17">13 May 2011</time>, <span>Emil Stoyanov</span> said...</div>
    
  <div>
        
            <div class="clearfix text-formatted field field--name-comment-body field--type-text-long field--label-hidden field__item"><p>
	Hi, </p>
<p>
	I followed the steps described above, but after the compilation shared modules (.so) are missing - only .a and .la files are present in modules/ directory.  Do you have any idea where could be the problem?</p></div>
      

    
    </div>

  <ul class="links inline"><li class="comment-forbidden"></li></ul>
</article>
<article  data-comment-user-id="0" id="comment-146" class="comment">
  
  <h3><a href="146.html#comment-146" class="permalink" rel="bookmark" hreflang="en">this is a good post</a></h3>
  

  <div class="submitted">On <time datetime="2013-11-04 13:00:34">4 Nov 2013</time>, <span>Robert</span> said...</div>
    
  <div>
        
            <div class="clearfix text-formatted field field--name-comment-body field--type-text-long field--label-hidden field__item"><p>this is a good post</p></div>
      

    
    </div>

  <ul class="links inline"><li class="comment-forbidden"></li></ul>
</article>


  
</section>

    </div>

          <footer class="link-wrapper">
          <div class="node__links">
    <ul class="links inline"><li class="comment-forbidden"></li></ul>  </div>

      </footer>
    
    
  </div>

</article>

  </div>

  </div>

  </main>

  <footer class="page-footer">
  	  <div class="region region-footer-top">
    <nav role="navigation" aria-labelledby="block-categories-menu" id="block-categories" class="block block-menu navigation menu--secondary-menu">
      
  <h2 id="block-categories-menu">Categories</h2>
  

        
              <ul class="menu">
                    <li class="menu-item">
        <a href="../taxonomy/term/6.html" title="
" data-drupal-link-system-path="taxonomy/term/6">Drupal</a>
              </li>
                <li class="menu-item">
        <a href="../taxonomy/term/1.html" title="" data-drupal-link-system-path="taxonomy/term/1">Freizeit</a>
              </li>
                <li class="menu-item">
        <a href="../taxonomy/term/2.html" title="" data-drupal-link-system-path="taxonomy/term/2">Gesellschaftskritik</a>
              </li>
                <li class="menu-item">
        <a href="../taxonomy/term/3.html" title="" data-drupal-link-system-path="taxonomy/term/3">Software</a>
              </li>
                <li class="menu-item">
        <a href="../taxonomy/term/5.html" title="" data-drupal-link-system-path="taxonomy/term/5">Uni</a>
              </li>
                <li class="menu-item">
        <a href="../taxonomy/term/4.html" title="" data-drupal-link-system-path="taxonomy/term/4">Uncategorized</a>
              </li>
        </ul>
  


  </nav>
<div id="block-writer-easybreeze-block-3" class="block block-block-content block-block-content31e9598c-b49e-4c82-af38-e5c72a6fb0c7">
  
    
      
            <div class="clearfix text-formatted field field--name-body field--type-text-with-summary field--label-hidden field__item"><p><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br />This work by <span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Klaus Purer</span> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
</div>
      
  </div>

  </div>

  	  	
  	<div class="foot-wrap clearfix">
                </div>
  </footer>
</div> <!-- end wrapper -->

  </div>

    
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"comment\/146","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en","currentQuery":{"page":0}},"pluralDelimiter":"\u0003","user":{"uid":0,"permissionsHash":"e96a7765a53cb802146dc48da3834d3a470ce957d28868afe583adf3bec8d6c5"}}</script>
<script src="../files/js/js_JdSNpE3Gh7Tv0XWwuGvbXkjYUqrXVCBIZ_Pf8-3EN4M.js"></script>

  </body>
</html>
